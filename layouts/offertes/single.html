<!doctype html>
<html lang="nl">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>{{ .Title }}</title>
    {{ if .Params.robots }}
      <meta name="robots" content="{{ .Params.robots }}" />
    {{ end }}
    <link rel="stylesheet" href="{{ "css/style.css" | absURL }}" />
  </head>
  <body>
    {{ if .Params.offerte_token }}
      <div
        id="login-screen"
        class="fixed inset-0 bg-gray-100 flex items-center justify-center">
        <div class="bg-white p-8 rounded-lg shadow-lg max-w-md w-full">
          <h2 class="text-2xl font-bold mb-4">Toegangscode vereist</h2>
          <p class="mb-4">
            Voer de toegangscode in die u per e-mail heeft ontvangen.
          </p>
          <input
            type="password"
            id="token-input"
            class="w-full border p-2 rounded mb-4"
            placeholder="Toegangscode" />
          <button
            onclick="checkToken()"
            class="w-full bg-blue-600 text-white p-2 rounded hover:bg-blue-700">
            Toegang
          </button>
          <p id="error-msg" class="text-red-600 mt-2 hidden">
            Onjuiste toegangscode
          </p>
        </div>
      </div>
    {{ end }}


    <main
      id="offerte-content"
      class="container mx-auto px-4 py-10"
      style="display: none;">
      {{ .Content }}
    </main>

    {{ if .Params.offerte_token }}
    <script>
        const correctToken = "{{ .Params.offerte_token }}";

        // Check if already authenticated
        if (sessionStorage.getItem('offerte_auth_{{ .File.UniqueID }}') === 'true') {
            showContent();
        }

        function checkToken() {
            const input = document.getElementById('token-input').value;
            if (input === correctToken) {
                sessionStorage.setItem('offerte_auth_{{ .File.UniqueID }}', 'true');
                showContent();
            } else {
                document.getElementById('error-msg').classList.remove('hidden');
            }
        }

        function showContent() {
            document.getElementById('login-screen').style.display = 'none';
            document.getElementById('offerte-content').style.display = 'block';
        }

        // Allow enter key
        document.getElementById('token-input')?.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') checkToken();
        });
    </script>
    {{ end }}
  </body>
</html>
